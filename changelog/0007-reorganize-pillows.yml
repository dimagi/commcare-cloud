title: Reorganize pillows
key: reorganize-pillows
date: 2018-11-26

optional_per_env: no

min_commcare_version: 44615b3a1eea823dc01a09c9809adae0b0f29812
max_commcare_version: 

context: |
  Pillows read changes from kafka and do various processing such as sending them to
  elasticsearch, transforming into a UCR table row etc. A doc for same change is read
  multiple times for each processor, since there are separte pillows for each processor.
  This is inefficient, so we have combined multiple processors that apply for a
  given document type (also called `KAFKA_TOPIC`) such as form/case/user under
  one pillow. For e.g. A new single `case-pillow` pillow replaces
  various old pillows that process case changes such as `CaseToElasticsearchPillow`,
  `CaseSearchToElasticsearchPillow`, `ReportCaseToElasticsearchPillow`,
  and `kafka-ucr-main` etc. 

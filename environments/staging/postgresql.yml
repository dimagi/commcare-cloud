DEFAULT_POSTGRESQL_HOST: rds_pg0

override:
  pgbouncer_pool_mode: transaction
  pgbouncer_max_connections: 1600
  postgresql_max_connections: 300
  pgbouncer_default_pool: 290

dbs:
  main:
    pgbouncer_host: pgproxy0
    query_stats: True
    pgpool_host: redis0
  ucr:
    pgbouncer_host: pgproxy0
    query_stats: True
  synclogs:
    pgbouncer_host: pgproxy0
  formplayer:
    pgbouncer_host: pgproxy0
  form_processing:
    proxy:
      host: pgproxy0
    partitions:
      p1:
        pgbouncer_host: pgproxy0
        shards: [0, 99]
        query_stats: True
      p2:
        pgbouncer_host: pgproxy0
        shards: [100, 199]
        query_stats: True
      p3:
        pgbouncer_host: pgproxy0
        shards: [200, 299]
        query_stats: True
      p4:
        pgbouncer_host: pgproxy0
        shards: [300, 399]
        query_stats: True
      p5:
        pgbouncer_host: pgproxy0
        shards: [400, 511]
        query_stats: True
  custom:
    - name: airflow
      pgbouncer_host: pgproxy0
      django_migrate: False

pgpool_config:
  redis0:
    primary: rds_pg0
    standbys:
      - rds_pg0_replica
    num_init_children: 59
    max_pool: 5
    database_redirect_preference_list: 'bench:1(0.5)'
    delay_threshold: 10

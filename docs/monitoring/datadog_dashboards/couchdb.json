{"notify_list":[],"description":"Overview of CouchDB","template_variables":[{"default":"*","prefix":"host","name":"couchdb"},{"default":"*","prefix":"environment","name":"scope"}],"is_read_only":false,"id":"hr7-uza-kw5","title":"CouchDB Dashboard","url":"/dashboard/hr7-uza-kw5/couchdb-dashboard","created_at":"2019-02-15T17:56:43.628421+00:00","modified_at":"2020-06-23T10:38:41.452675+00:00","author_handle":"jemord@dimagi.com","widgets":[{"definition":{"custom_links":[],"title_size":"16","title":"Number of HTTPD requests by type","title_align":"left","show_legend":false,"requests":[{"q":"per_minute(avg:couchdb.couchdb.httpd_request_methods.GET{$couchdb,$scope}), per_minute(avg:couchdb.couchdb.httpd_request_methods.PUT{$couchdb,$scope}), per_minute(avg:couchdb.couchdb.httpd_request_methods.POST{$couchdb,$scope}), per_minute(avg:couchdb.couchdb.httpd_request_methods.DELETE{$couchdb,$scope})","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"area"}],"type":"timeseries","legend_size":"0"},"layout":{"y":24,"x":37,"height":15,"width":36},"id":0},{"definition":{"custom_links":[],"title_size":"16","title":"","title_align":"left","show_legend":false,"requests":[{"q":"avg:trace.requests.request.errors.by_http_status{$scope} by {http.status_code}.as_count()","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"bars"}],"type":"timeseries","legend_size":"0"},"layout":{"y":120,"x":37,"height":18,"width":36},"id":1},{"definition":{"custom_links":[],"title_size":"16","title":"Open databases","title_align":"left","custom_unit":"DBs","precision":0,"time":{"live_span":"10m"},"autoscale":true,"requests":[{"q":"avg:couchdb.couchdb.open_databases{$couchdb,$scope}","aggregator":"avg"}],"type":"query_value"},"layout":{"y":0,"x":21,"height":15,"width":20},"id":2},{"definition":{"custom_links":[],"title_size":"16","title":"Average request latency","title_align":"left","show_legend":false,"requests":[{"q":"per_second(avg:couchdb.couchdb.request_time.arithmetic_mean{$couchdb,$scope}), per_second(avg:couchdb.couchdb.request_time.percentile.95{$couchdb,$scope})","style":{"line_width":"normal","palette":"warm","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":40,"x":74,"height":15,"width":34},"id":3},{"definition":{"custom_links":[],"title_size":"16","title":"Auth cache misses","title_align":"left","precision":0,"time":{"live_span":"1h"},"requests":[{"q":"avg:couchdb.couchdb.auth_cache_misses{$couchdb,$scope}","aggregator":"avg","conditional_formats":[{"palette":"red_on_white","value":5,"comparator":">="},{"palette":"yellow_on_white","value":2,"comparator":">="}]}],"type":"query_value"},"layout":{"y":24,"x":125,"height":15,"width":16},"id":4},{"definition":{"custom_links":[],"title_size":"16","title":"Workload - Reads (green) & Writes (purple)","title_align":"left","yaxis":{"include_zero":false,"scale":"log"},"show_legend":false,"requests":[{"q":"per_second(avg:couchdb.couchdb.database_reads{$couchdb,$scope}), per_second(avg:couchdb.couchdb.database_writes{$couchdb,$scope})","style":{"line_width":"normal","palette":"green","line_type":"solid"},"display_type":"area"}],"type":"timeseries","legend_size":"0"},"layout":{"y":24,"x":74,"height":15,"width":34},"id":5},{"definition":{"custom_links":[],"title_size":"16","title":"Request with status code of 4xx and 5xx","title_align":"left","show_legend":false,"requests":[{"q":"per_minute(avg:couchdb.couchdb.httpd_status_codes.409{$scope,$couchdb}), per_minute(avg:couchdb.couchdb.httpd_status_codes.412{$scope,$couchdb}), per_minute(avg:couchdb.couchdb.httpd_status_codes.405{$scope,$couchdb}), per_minute(avg:couchdb.couchdb.httpd_status_codes.404{$scope,$couchdb}), per_minute(avg:couchdb.couchdb.httpd_status_codes.403{$scope,$couchdb}), per_minute(avg:couchdb.couchdb.httpd_status_codes.401{$scope,$couchdb}), per_minute(avg:couchdb.couchdb.httpd_status_codes.400{$scope,$couchdb})","style":{"line_width":"normal","palette":"warm","line_type":"solid"},"display_type":"area"},{"q":"per_minute(avg:couchdb.couchdb.httpd_status_codes.500{$scope,$couchdb}), per_minute(avg:couchdb.couchdb.httpd_status_codes.501{$scope,$couchdb}), per_minute(avg:couchdb.couchdb.httpd_status_codes.503{$scope,$couchdb})","style":{"line_width":"normal","palette":"purple","line_type":"solid"},"display_type":"area"}],"type":"timeseries","legend_size":"0"},"layout":{"y":56,"x":37,"height":15,"width":36},"id":6},{"definition":{"title_size":"16","title":"Data size","title_align":"left","yaxis":{"max":"auto","include_zero":true,"scale":"linear","min":"auto","label":""},"show_legend":false,"time":{},"requests":[{"q":"sum:couchdb.by_db.file_size{$couchdb,$scope} by {db}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":0,"x":86,"height":15,"width":20},"id":7},{"definition":{"custom_links":[],"title_size":"16","title":"Number of bulk requests","title_align":"left","show_legend":false,"requests":[{"q":"per_second(avg:couchdb.couchdb.httpd.bulk_requests{$couchdb,$scope})","style":{"line_width":"normal","palette":"cool","line_type":"solid"},"display_type":"area"}],"type":"timeseries","legend_size":"0"},"layout":{"y":40,"x":0,"height":15,"width":36},"id":8},{"definition":{"custom_links":[],"title_size":"16","title":"Request with status code of 2xx","title_align":"left","show_legend":false,"requests":[{"q":"per_minute(avg:couchdb.couchdb.httpd_status_codes.201{$couchdb,$scope}), per_minute(avg:couchdb.couchdb.httpd_status_codes.200{$couchdb,$scope})","style":{"line_width":"normal","palette":"green","line_type":"solid"},"display_type":"area"}],"type":"timeseries","legend_size":"0"},"layout":{"y":40,"x":37,"height":15,"width":36},"id":9},{"definition":{"tick_pos":"50%","show_tick":true,"type":"note","tick_edge":"bottom","text_align":"center","content":"Throughput","font_size":"18","background_color":"gray"},"layout":{"y":17,"x":0,"height":5,"width":36},"id":10},{"definition":{"tick_pos":"50%","show_tick":true,"type":"note","tick_edge":"bottom","text_align":"center","content":"Performance","font_size":"18","background_color":"gray"},"layout":{"y":17,"x":74,"height":5,"width":34},"id":11},{"definition":{"tick_pos":"50%","show_tick":true,"type":"note","tick_edge":"bottom","text_align":"center","content":"Traffic Breakdown","font_size":"18","background_color":"gray"},"layout":{"y":17,"x":37,"height":5,"width":36},"id":12},{"definition":{"tick_pos":"50%","show_tick":true,"type":"note","tick_edge":"bottom","text_align":"center","content":"Authentication Cache","font_size":"18","background_color":"gray"},"layout":{"y":17,"x":109,"height":5,"width":32},"id":13},{"definition":{"custom_links":[],"title_size":"16","title":"Unauthorized login attempt","title_align":"left","markers":[{"display_type":"error dashed","value":"y = 3"}],"show_legend":false,"requests":[{"q":"avg:couchdb.httpd_status_codes.401{$couchdb,$scope}","style":{"line_width":"normal","palette":"red","line_type":"solid"},"display_type":"line"},{"q":"avg:couchdb.couchdb.auth_cache_misses{$couchdb,$scope}","style":{"line_width":"normal","palette":"orange","line_type":"solid"},"display_type":"bars"},{"q":"avg:couchdb.couchdb.auth_cache_hits{$couchdb,$scope}","style":{"line_width":"normal","palette":"orange","line_type":"solid"},"display_type":"bars"}],"type":"timeseries","legend_size":"0"},"layout":{"y":40,"x":109,"height":15,"width":32},"id":14},{"definition":{"custom_links":[],"title_size":"16","title":"HTTP Request Rate","title_align":"left","show_legend":false,"requests":[{"q":"per_second(avg:couchdb.couchdb.httpd.requests{$couchdb,$scope})","style":{"line_width":"normal","palette":"cool","line_type":"solid"},"display_type":"area"}],"type":"timeseries","legend_size":"0"},"layout":{"y":24,"x":0,"height":15,"width":36},"id":15},{"definition":{"custom_links":[],"title_size":"16","title":"Network traffic (proxy)","title_align":"left","show_legend":false,"requests":[{"q":"avg:system.net.bytes_rcvd{$scope,group:couchdb2_proxy} by {host}, -avg:system.net.bytes_sent{$scope,group:couchdb2_proxy} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":104,"x":0,"height":15,"width":36},"id":16},{"definition":{"title_size":"16","title":"Doc count","title_align":"left","yaxis":{"max":"auto","include_zero":true,"scale":"linear","min":"auto","label":""},"show_legend":false,"time":{},"requests":[{"q":"sum:couchdb.by_db.doc_count{$couchdb,$scope} by {db}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":0,"x":63,"height":15,"width":22},"id":17},{"definition":{"custom_links":[],"title_size":"16","title":"File descriptors","title_align":"left","precision":2,"time":{"live_span":"10m"},"autoscale":true,"requests":[{"q":"sum:couchdb.couchdb.open_os_files{$couchdb,$scope}","aggregator":"avg"}],"type":"query_value"},"layout":{"y":0,"x":42,"height":15,"width":20},"id":18},{"definition":{"custom_links":[],"title_size":"16","title":"","title_align":"left","show_legend":false,"requests":[{"q":"sum:couchdb.couch_replicator.jobs.crashes{$scope,$couchdb}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"},{"q":"sum:couchdb.couch_replicator.worker_deaths{$couchdb,$scope}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":104,"x":109,"height":15,"width":32},"id":19},{"definition":{"custom_links":[],"title_size":"16","title":"Change feed clients","title_align":"left","show_legend":false,"requests":[{"q":"avg:couchdb.couchdb.httpd.clients_requesting_changes{$couchdb,$scope}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":56,"x":0,"height":15,"width":36},"id":20},{"definition":{"custom_links":[],"title_size":"16","title":"Time to open database (ms)","title_align":"left","show_legend":false,"requests":[{"q":"avg:couchdb.couchdb.db_open_time.arithmetic_mean{$scope,$couchdb}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":56,"x":74,"height":15,"width":34},"id":21},{"definition":{"custom_links":[],"title_size":"16","title":"Document inserts and updates","title_align":"left","show_legend":false,"requests":[{"q":"per_minute(avg:couchdb.couchdb.document_inserts{$scope,$couchdb}), per_minute(avg:couchdb.couchdb.document_writes{$scope,$couchdb})","style":{"line_width":"normal","palette":"cool","line_type":"solid"},"display_type":"area"}],"type":"timeseries","legend_size":"0"},"layout":{"y":72,"x":0,"height":15,"width":36},"id":22},{"definition":{"custom_links":[],"title_size":"16","title":"IO Wait","title_align":"left","show_legend":false,"requests":[{"q":"outliers(avg:system.io.await{$scope,$couchdb,group:couchdb2} by {host}, 'DBSCAN', 3)","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":72,"x":74,"height":15,"width":34},"id":23},{"definition":{"title_size":"16","title":"Active tasks","title_align":"left","yaxis":{"max":"auto","include_zero":true,"scale":"linear","min":"auto","label":""},"show_legend":false,"time":{},"requests":[{"q":"sum:couchdb.active_tasks.indexer.count{$couchdb,$scope}, sum:couchdb.active_tasks.replication.count{$couchdb,$scope}, sum:couchdb.active_tasks.db_compaction.count{$couchdb,$scope}, sum:couchdb.active_tasks.view_compaction.count{$scope}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"area","metadata":[{"alias_name":"index","expression":"sum:couchdb.active_tasks.indexer.count{$couchdb,$scope}"},{"alias_name":"replication","expression":"sum:couchdb.active_tasks.replication.count{$couchdb,$scope}"},{"alias_name":"db_compaction","expression":"sum:couchdb.active_tasks.db_compaction.count{$couchdb,$scope}"},{"alias_name":"view_compaction","expression":"sum:couchdb.active_tasks.view_compaction.count{$couchdb,$scope}"}]}],"type":"timeseries","legend_size":"0"},"layout":{"y":56,"x":109,"height":15,"width":32},"id":24},{"definition":{"custom_links":[],"title_size":"16","title":"Collect results","title_align":"left","show_legend":false,"requests":[{"q":"avg:couchdb.couchdb.collect_results_time.arithmetic_mean{$couchdb,$scope}, avg:couchdb.couchdb.collect_results_time.percentile.99{$couchdb,$scope}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":88,"x":74,"height":15,"width":34},"id":25},{"definition":{"custom_links":[],"title_size":"16","title":"DB open time","title_align":"left","show_legend":false,"requests":[{"q":"avg:couchdb.couchdb.db_open_time.arithmetic_mean{$couchdb,$scope}, avg:couchdb.couchdb.db_open_time.percentile.99{$couchdb,$scope}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":88,"x":37,"height":15,"width":36},"id":26},{"definition":{"custom_links":[],"title_size":"16","title":"CPU Load (nodes)","title_align":"left","show_legend":false,"requests":[{"q":"avg:system.load.norm.5{$scope,$couchdb,group:couchdb2} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":72,"x":109,"height":15,"width":32},"id":27},{"definition":{"custom_links":[],"title_size":"16","title":"Memory used (nodes)","title_align":"left","markers":[{"display_type":"error dashed","value":"y = 100"}],"show_legend":false,"requests":[{"q":"100*(1-avg:system.mem.pct_usable{$scope,$couchdb,group:couchdb2} by {host})","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":88,"x":109,"height":15,"width":32},"id":28},{"definition":{"custom_links":[],"title_size":"16","title":"CPU Load (proxy)","title_align":"left","show_legend":false,"requests":[{"q":"avg:system.load.norm.5{$scope,group:couchdb2_proxy} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":104,"x":37,"height":15,"width":36},"id":29},{"definition":{"custom_links":[],"title_size":"16","title":"Memory used (proxy)","title_align":"left","markers":[{"display_type":"error dashed","value":"y = 100"}],"show_legend":false,"requests":[{"q":"100*(1-avg:system.mem.pct_usable{$scope,group:couchdb2_proxy} by {host})","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":104,"x":74,"height":15,"width":34},"id":30},{"definition":{"custom_links":[],"title_size":"16","title":"Auth cache hits","title_align":"left","precision":2,"autoscale":true,"requests":[{"q":"avg:couchdb.couchdb.auth_cache_hits{$couchdb,$scope}","aggregator":"avg"}],"type":"query_value"},"layout":{"y":24,"x":109,"height":15,"width":15},"id":31},{"definition":{"title_size":"16","title":"Service status","title_align":"left","group_by":["instance"],"time":{"live_span":"10m"},"group":"instance:http://localhost:5984,host:marshal-couchdb-1","type":"check_status","check":"couchdb.can_connect","tags":["$scope"],"grouping":"cluster"},"layout":{"y":0,"x":0,"height":15,"width":20},"id":32},{"definition":{"title_size":"16","title":"Design doc size","title_align":"left","yaxis":{"max":"auto","include_zero":true,"scale":"linear","min":"auto","label":""},"show_legend":false,"time":{},"requests":[{"q":"sum:couchdb.by_ddoc.file_size{$couchdb,$scope} by {design_document}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":0,"x":107,"height":15,"width":20},"id":33},{"definition":{"title_size":"16","title":"Disk usage","title_align":"left","yaxis":{"max":"auto","include_zero":true,"scale":"linear","min":"auto","label":""},"show_legend":false,"time":{},"requests":[{"q":"sum:system.disk.used{$couchdb,$scope,group:couchdb2,device:/opt/data} by {host}+sum:system.disk.used{$couchdb,$scope,group:couchdb2,device:/opt/data/ecrypt}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":0,"x":128,"height":15,"width":20},"id":34},{"definition":{"custom_links":[],"title_size":"16","title":"Disk Usage by host","title_align":"left","show_legend":false,"requests":[{"q":"top(top(avg:system.disk.used{environment:icds,device:/opt/data,group:couchdb2} by {host}, 100, 'mean', 'desc')+top(avg:system.disk.used{environment:icds,group:couchdb2,device:/opt/data/ecrypt} by {host}, 100, 'mean', 'desc'),10,'mean','desc')","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":88,"x":0,"height":15,"width":36},"id":35},{"definition":{"custom_links":[],"title_size":"16","title":"View Reads","title_align":"left","show_legend":false,"requests":[{"q":"per_minute(avg:couchdb.couchdb.httpd.view_reads{$scope,$couchdb})","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"area"}],"type":"timeseries","legend_size":"0"},"layout":{"y":72,"x":37,"height":15,"width":36},"id":37},{"definition":{"style":{"palette":"green_to_orange","palette_flip":false},"custom_links":[],"title_size":"16","title":"Couch Nodes","title_align":"left","no_metric_hosts":true,"group":["availability-zone"],"requests":{"size":{"q":"avg:system.mem.pct_usable{group:couchdb2,$scope} by {host}"},"fill":{"q":"avg:system.load.norm.5{group:couchdb2,$scope} by {host}"}},"no_group_hosts":true,"type":"hostmap","scope":["group:couchdb2","$scope"]},"layout":{"y":120,"x":0,"height":18,"width":36},"id":38},{"definition":{"custom_links":[],"title_size":"16","title":"Couch client timings by DB","title_align":"left","yaxis":{"include_zero":false,"scale":"sqrt"},"show_legend":false,"requests":[{"q":"avg:couch.timings{$scope} by {database}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":120,"x":109,"height":18,"width":32},"id":39},{"definition":{"custom_links":[],"title_size":"16","title":"Disk IOPS","title_align":"left","show_legend":false,"requests":[{"q":"sum:system.io.r_s{$couchdb,$scope,device:vdb,group:couchdb2}, sum:system.io.w_s{$couchdb,$scope,device:vdb,group:couchdb2}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"area"}],"type":"timeseries","legend_size":"0"},"layout":{"y":139,"x":0,"height":15,"width":47},"id":40},{"definition":{"custom_links":[],"title_size":"16","title":"CPU Usage (%)","title_align":"left","show_legend":false,"requests":[{"q":"avg:system.cpu.idle{$scope,$couchdb}, avg:system.cpu.system{$scope,$couchdb}, avg:system.cpu.iowait{$scope,$couchdb}, avg:system.cpu.user{$scope,$couchdb}, avg:system.cpu.stolen{$scope,$couchdb}, avg:system.cpu.guest{$scope,$couchdb}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"area"}],"type":"timeseries","legend_size":"0"},"layout":{"y":72,"x":142,"height":15,"width":32},"id":41},{"definition":{"custom_links":[],"title_size":"16","title":"Network traffic (nodes)","title_align":"left","show_legend":false,"requests":[{"q":"avg:system.net.bytes_rcvd{$scope,group:couchdb2} by {host}, -avg:system.net.bytes_sent{$scope,group:couchdb2} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":139,"x":48,"height":15,"width":36},"id":42},{"definition":{"custom_links":[],"title_size":"16","yaxis":{"max":"100"},"title_align":"left","markers":[{"display_type":"error dashed","value":"80 < y < 100"}],"show_legend":false,"title":"HAProxy frontend session %","requests":[{"q":"avg:haproxy.frontend.session.pct{$scope,service:couchdb2-front}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":120,"x":74,"height":9,"width":34},"id":43},{"definition":{"title_size":"16","yaxis":{"max":"auto","include_zero":true,"scale":"linear","min":"auto","label":""},"title_align":"left","markers":[{"value":"80 < y < 100"}],"show_legend":false,"time":{},"title":"HAProxy backend session %","requests":[{"q":"sum:haproxy.backend.session.pct{$scope}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","legend_size":"0"},"layout":{"y":130,"x":74,"height":8,"width":34},"id":44}],"layout_type":"free"}
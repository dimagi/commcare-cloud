---
- hosts: airflow_scheduler
  tasks:
    - name: "Check host count in airflow_scheduler group"
      assert:
        that: 
          - groups.airflow_scheduler |length == 1
        fail_msg: "No of host in airflow group shouldn't exceed 1"

- name: Airflow
  hosts: airflow
  roles:
    - role: airflow
      tags: airflow 
      when: groups.airflow |length == 1
